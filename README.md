# Operating System
Simple boot sector written in x86\_64 Assembly

## Required packages
- make (For makefile)
- nasm (For compiling binary)
- qemu (For emulation)
- cdrtools (For generating ISO)

## Cloning and execution
#### Clone repository
```sh
git clone https://github.com/manankarnik/operating-system.git
```

#### Change directory
```sh
cd operating-system
```

#### Compile binary
Uses nasm to compile to bin
```sh
make
```

#### Emulate
Uses qemu-system-x86\_64 to emulate boot sector
```sh
make run
```

#### Generate ISO
ISO can be attached to virtualbox (not tested on hardware)
```sh
make iso
```

#### Delete generated files
Removes all iso and bin files generated by make
```sh
make clean
```

## Functions
#### printf
Prints a string using int 0x10. Move the string defined by db to si register.
- 0x0a:	Line Feed (New line)
- 0x0d:	Carriage Return
- 0:	Terminates string
```asm
mov     si, STR
call    printf
STR:	db "Hello World!", 0x0a, 0x0d, 0
```

#### printh
Prints a hexadeimal value (0x****). Move either a hexadecimal or memory address to dx register.
```asm
mov     dx, 0x****
call    printh
```

#### readDisk
Reads value from sector. Move number of sectors to read in al and the sector to be read in cl registers.
```asm
mov     al, 1
mov     cl, 2
call    readDisk
```

#### testA20
Function to test if the A20 line is enabled or disabled. Returns value to ax.
- 0: Disabled
- 1: Enabled
```asm
call	testA20

;; Print return value
mv	dx, ax
call	printh
```

#### enableA20
Function to enable A20 line
```asm
call	enableA20
```

## Reference
[Writing an Operating System - theMike97_ (Youtube playlist)](https://www.youtube.com/playlist?list=PLmlvkUN3-1MNKwINqdCDtTdNDjfBmWcZA)
